{% extends 'shop/base.html' %}
{% load static %}
{% block title %}Заказы{% endblock %}

{% block content %}
<div class="container mt-4">
    <h3 class="py-2">
        Мои заказы
    </h3>
    <!-- Перебор всех заказов и связанных с ними продуктов -->
    {% for order, products in orders_with_products %}
        <div class="mb-4 p-3 border rounded">
            <h5 class="mb-3">Заказ от {{ order.created_date|date:"d M Y" }}</h5>
            <!-- Перебор продуктов в заказе -->
            {% for op in products %}
                <div class="row mb-2 align-items-center">
                    <div class="col-6 col-sm-6 col-md-3 col-lg-2">
                        <img src="{{ op.id_product.image.url }}" alt="{{ op.id_product.title }}" class="img-fluid rounded product-image" style="min-height: 200px;">
                    </div>
                    <div class="col-6 col-sm-6 col-md-9 col-lg-10">
                        <a href="{{ op.id_product.get_absolute_url }}" class="text-dark font-weight-bold"
                           style="text-decoration: none;">{{ op.id_product.title }}</a>
                        <p class="mt-3">{{ op.id_product.price }} ₽</p>
                        <p>Количество: {{ op.quantity }}</p>
                    </div>
                </div>
            {% endfor %}
            <div class="d-flex justify-content-between align-items-center mt-3">
                <p class="font-weight-bold mt-3">Итоговая цена: {{ order.total_cost }} ₽</p>
                <p class="status-{{ order.status }} mt-3">
                    {% with status=order.get_status_display %}
                        Статус: {{ status }}
                    {% endwith %}
                </p>
            </div>
        </div>
    {% empty %}
        <div class="text-center">
            <img width="300" src="{% static 'shop/img/cat.png' %}" alt="No orders" class="img-fluid">
            <h5>У вас пока нет заказов.</h5>
            <p>Воспользуйтесь поиском или перейдите в каталог, чтобы найти интересные товары.</p>
            <!-- Пример ссылки на каталог -->
            <a href="/" class="btn btn-primary mt-3">Перейти в каталог</a>
        </div>
    {% endfor %}
</div>

{% endblock content %}


